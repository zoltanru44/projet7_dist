(function(e){function t(t){for(var n,r,i=t[0],c=t[1],u=t[2],d=0,m=[];d<i.length;d++)r=i[d],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&m.push(o[r][0]),o[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);l&&l(t);while(m.length)m.shift()();return a.push.apply(a,u||[]),s()}function s(){for(var e,t=0;t<a.length;t++){for(var s=a[t],n=!0,i=1;i<s.length;i++){var c=s[i];0!==o[c]&&(n=!1)}n&&(a.splice(t--,1),e=r(r.s=s[0]))}return e}var n={},o={app:0},a=[];function r(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=n,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(s,n,function(t){return e[t]}.bind(null,n));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=c;a.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"206d":function(e,t,s){"use strict";var n=s("4413"),o=s.n(n);o.a},"21da":function(e,t,s){"use strict";var n=s("effc"),o=s.n(n);o.a},"2a37":function(e,t,s){"use strict";var n=s("5ccf"),o=s.n(n);o.a},4413:function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var n=s("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("div",{attrs:{id:"app"}},[n("img",{attrs:{src:s("b78e"),id:"logo_groupo_head",alt:"logo_groupo"}}),n("div",{staticClass:"elevation-10 rounded mx-auto my-5 center col-md-4 col-sm-6 center",attrs:{id:"nav"}},[0==e.isConnected()?n("router-link",{attrs:{to:"/"}},[e._v(" Inscription")]):e._e(),0==e.isConnected()?n("span",[e._v(" | ")]):e._e(),0==e.isConnected()?n("router-link",{attrs:{to:"/login"}},[e._v(" Connexion ")]):e._e(),1==e.isConnected()?n("router-link",{attrs:{to:"/blackboard"}},[e._v(" Blackboard")]):e._e(),1==e.isConnected()?n("span",[e._v(" | ")]):e._e(),1==e.isConnected()?n("router-link",{attrs:{to:"/profile"}},[e._v(" Mon profil")]):e._e(),1==e.isConnected()?n("span",[e._v(" | ")]):e._e(),1==e.isConnected()?n("router-link",{attrs:{to:"/logout"}},[e._v(" Déconnexion ")]):e._e()],1),n("router-view"),n("div",[n("v-footer",{staticClass:"my-4",attrs:{padless:""}},[n("v-row",{attrs:{justify:"center"}},e._l(e.links,(function(t){return n("v-btn",{key:t,staticClass:"my-2 mx-4",attrs:{test:"",rounded:""}},[e._v(" "+e._s(t)+" ")])})),1),n("v-col",{staticClass:"text-center py-4",attrs:{cols:"12"}},[e._v("Groupomania - "+e._s((new Date).getFullYear()))])],1)],1)],1)])},a=[],r={data:function(){return{links:["A propos","FAQ","Mentions légales"]}},methods:{isConnected:function(){return!!sessionStorage.getItem("user")}}},i=r,c=(s("5c0b"),s("2877")),u=s("6544"),l=s.n(u),d=s("7496"),m=s("8336"),p=s("62ad"),f=s("553a"),v=s("0fd9"),g=Object(c["a"])(i,o,a,!1,null,null,null),_=g.exports;l()(g,{VApp:d["a"],VBtn:m["a"],VCol:p["a"],VFooter:f["a"],VRow:v["a"]});var h=s("8c4f"),w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"signup"},[n("v-container",{staticClass:"col-md-8 elevation-10 rounded"},[n("img",{staticClass:"logo_groupo",attrs:{alt:"logo-groupomania",src:s("ec02")}}),n("h1",[e._v("Bienvenue sur GroupoNetwork !")]),n("h2",[e._v("Avant de pouvoir partager avec vos collègues, merci de créer un compte.")]),n("v-form",{ref:"form",staticClass:"signup__form col-md-4",attrs:{id:"signup__form"},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-text-field",{attrs:{rules:e.emailRules,label:"Email",required:"",type:"email"},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}}),n("v-text-field",{attrs:{rules:e.usernameRules,label:"Nom d'utilisateur",required:""},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}}),n("v-text-field",{attrs:{rules:e.passwordRules,label:"Mot de passe",required:"",type:"password"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}}),n("div",{staticClass:"text-center",attrs:{id:"btn_snackbar"}},[n("v-btn",{staticClass:"mr-4",attrs:{disabled:!e.valid,color:"success"},on:{click:function(t){return e.validate_signup()}}},[e._v(" Valider votre inscription ")]),n("v-snackbar",{attrs:{color:e.ClrSnack,"multi-line":e.multiLine},scopedSlots:e._u([{key:"action",fn:function(t){var s=t.attrs;return[n("v-btn",e._b({on:{click:function(t){e.snackbar=!1}}},"v-btn",s,!1),[e._v(" Fermer ")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.resultMessage)+" ")])],1)],1)],1)],1)},b=[],k=(s("96cf"),s("1da1")),x=s("bc3a"),C={name:"SignUp",data:function(){return{user:{username:"",email:"",password:""},valid:!1,snackbar:!1,multiLine:!0,ClrSnack:"grey",resultMessage:"",text:"",lazy:!1,emailRules:[function(e){return!!e||"E-mail is required"},function(e){return/.+@.+\..+/.test(e)||"E-mail must be valid"}],usernameRules:[function(e){return!!e||"Name is required"},function(e){return e&&e.length<=10||"Name must be less than 10 characters"}],passwordRules:[function(e){return!!e||"Password is required"},function(e){return e&&e.length<=10||"Password must be less than 10 characters"}]}},methods:{validate_signup:function(){var e=this,t={username:this.user.username,email:this.user.email,password:this.user.password},s=function(){var s=Object(k["a"])(regeneratorRuntime.mark((function s(){var n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,x.post("http://localhost:3000/api/auth/signup",t);case 3:n=s.sent,e.resultMessage=n.data.message,201==n.status&&(e.ClrSnack="success",e.login_delay()),200==n.status&&(e.ClrSnack="error"),s.next=12;break;case 9:s.prev=9,s.t0=s["catch"](0),console.log(s.t0);case 12:case"end":return s.stop()}}),s,null,[[0,9]])})));return function(){return s.apply(this,arguments)}}();s(),this.snackbar=!0},login_delay:function(){var e=this,t={username:this.user.username,password:this.user.password},s=function(){var s=Object(k["a"])(regeneratorRuntime.mark((function s(){var n,o,a,r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,x.post("http://localhost:3000/api/auth/login",t);case 3:if(n=s.sent,e.resultMessage="Vous êtes connecté sous le nom de ".concat(n.data.username),201!=n.status){s.next=17;break}return console.log("Vous êtes connecté sous le nom de ".concat(n.data.username)),o={userName:n.data.username,user_id:n.data.userId,user_role:n.data.userRole,email:n.data.email,token:n.data.token},console.log(n),a=JSON.stringify(o),sessionStorage.setItem("user",a),console.log(sessionStorage.getItem("user")),r={token:n.data.token,username:n.data.username,userRole:n.data.userRole},console.log(r),e.$store.dispatch("connected",r),console.log(e.$store.state.connexion.isConnected),s.abrupt("return",{message:"Vous êtes connecté sous le nom de ".concat(n.data.username)});case 17:200==n.status&&(e.resultMessage=n.data.err),s.next=23;break;case 20:s.prev=20,s.t0=s["catch"](0),console.log(s.t0);case 23:case"end":return s.stop()}}),s,null,[[0,20]])})));return function(){return s.apply(this,arguments)}}();setTimeout((function(){s()}),1e3),setTimeout((function(){document.location.href="/blackboard"}),4e3)}}},y=C,N=(s("21da"),s("a523")),T=s("4bd4"),D=s("2db4"),M=s("8654"),S=Object(c["a"])(y,w,b,!1,null,null,null),P=S.exports;l()(S,{VBtn:m["a"],VContainer:N["a"],VForm:T["a"],VSnackbar:D["a"],VTextField:M["a"]});var R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login"},[n("v-container",{staticClass:"col-md-8 elevation-10 rounded"},[n("img",{staticClass:"logo_groupo",attrs:{alt:"logo-groupomania",src:s("ec02")}}),n("h1",[e._v("Bienvenue sur GroupoNetwork !")]),n("h2",[e._v("Avant de pouvoir partager avec vos collègues, merci de vous connecter.")]),n("v-form",{ref:"form",staticClass:"login__form col-md-4",attrs:{id:"login__form"},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-text-field",{attrs:{rules:e.usernameRules,label:"Nom d'utilisateur",required:""},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}}),n("v-text-field",{attrs:{rules:e.passwordRules,label:"Mot de passe",required:"",type:"password"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}}),n("div",{staticClass:"text-center",attrs:{id:"btn_snackbar"}},[n("v-btn",{staticClass:"mr-4",attrs:{disabled:!e.valid,color:"success"},on:{click:function(t){return e.validate_async()}}},[e._v(" Connexion ")]),n("v-snackbar",{attrs:{color:e.ClrSnack,"multi-line":e.multiLine},scopedSlots:e._u([{key:"action",fn:function(t){var s=t.attrs;return[n("v-btn",e._b({on:{click:function(t){e.snackbar=!1}}},"v-btn",s,!1),[e._v(" Fermer ")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.resultMessage)+" ")])],1)],1)],1)],1)},V=[],G=s("bc3a"),O={name:"Login",data:function(){return{user:{username:"",password:""},valid:!1,snackbar:!1,multiLine:!0,ClrSnack:"grey",resultMessage:"",usernameRules:[function(e){return!!e||"Name is required"},function(e){return e&&e.length<=10||"Name must be less than 10 characters"}],passwordRules:[function(e){return!!e||"Name is required"},function(e){return e&&e.length<=10||"Name must be less than 10 characters"}]}},mounted:function(){console.log(this.$store.state.isConnected)},methods:{redirection:function(){setTimeout((function(){document.location.href="/blackboard"}),3e3)},validate_async:function(){var e=this,t={username:this.user.username,password:this.user.password},s=function(){var s=Object(k["a"])(regeneratorRuntime.mark((function s(){var n,o,a,r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,G.post("http://localhost:3000/api/auth/login",t);case 3:if(n=s.sent,e.resultMessage="Vous êtes connecté sous le nom de ".concat(n.data.username),201!=n.status){s.next=17;break}return e.ClrSnack="success",console.log("Vous êtes connecté sous le nom de ".concat(n.data.username)),o={userName:n.data.username,user_id:n.data.userId,user_role:n.data.userRole,email:n.data.email,token:n.data.token},console.log(n),a=JSON.stringify(o),sessionStorage.setItem("user",a),console.log(sessionStorage.getItem("user")),r={token:n.data.token,username:n.data.username,userRole:n.data.userRole},console.log(r),setTimeout((function(){document.location.href="/blackboard"}),3e3),s.abrupt("return",{message:"Vous êtes connecté sous le nom de ".concat(n.data.username)});case 17:200==n.status&&(e.resultMessage=n.data.err,e.ClrSnack="error"),console.log(n.data.message),console.log(e.resultMessage),s.next=25;break;case 22:s.prev=22,s.t0=s["catch"](0),console.log(s.t0);case 25:case"end":return s.stop()}}),s,null,[[0,22]])})));return function(){return s.apply(this,arguments)}}();s(),this.snackbar=!0}}},I=O,j=(s("206d"),Object(c["a"])(I,R,V,!1,null,null,null)),A=j.exports;l()(j,{VBtn:m["a"],VContainer:N["a"],VForm:T["a"],VSnackbar:D["a"],VTextField:M["a"]});var L=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"blackboard",attrs:{id:"Blackboard"}},[e.loading?s("div",{staticClass:"loarding"},[s("h1",[e._v("Chargement en cours")])]):e._e(),e.load?s("div",{staticClass:"container",attrs:{id:"board"}},[s("v-form",{ref:"form",staticClass:"post_form elevation-10 rounded ma-6 center",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[s("v-container",[s("v-text-field",{staticClass:"inputNotRed",attrs:{rules:e.newPostRules,label:"Nouveau Post"},model:{value:e.newPost,callback:function(t){e.newPost=t},expression:"newPost"}}),s("div",{staticClass:"text-center",attrs:{id:"btn_snackbar"}},[s("v-btn",{staticClass:"mr-4",attrs:{disabled:!e.valid,color:"success"},on:{click:function(t){e.sendNewPost(),e.getNumberOfPosts(),e.getAllPosts(),e.shuffleArray()}}},[e._v(" Poster ")]),s("v-snackbar",{attrs:{color:e.ClrSnack,"multi-line":e.multiLine},scopedSlots:e._u([{key:"action",fn:function(t){var n=t.attrs;return[s("v-btn",e._b({on:{click:function(t){e.snackbar=!1}}},"v-btn",n,!1),[e._v(" Fermer ")])]}}],null,!1,1803816659),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.resultMessage)+" ")])],1)],1)],1),s("div",{staticClass:"elevation-10 rounded ma-6"},[e._l(e.posts,(function(t,n){return s("div",{key:t.id},[s("v-card",{staticClass:"mx-auto my-5",style:[{"background-color":e.colorArray[n]}],attrs:{dark:""}},[s("v-card-text",{staticClass:"headline font-weight-bold white--text"},[e._v('"'+e._s(t.text)+'"')]),s("v-card-subtitle",{staticClass:"white--text"},[null!==t.username?s("span",[e._v("@"+e._s(t.username))]):e._e(),null==t.username?s("span",[e._v("L'auteur à supprimé son compte,")]):e._e(),t.modification_date?e._e():s("span",[s("br"),e._v("publié il y a "),e.GetTimeDifferenceNow(t.date,t.time).day?s("span",[e._v(e._s(e.GetTimeDifferenceNow(t.date,t.time).day)+" jours et ")]):e._e(),e.GetTimeDifferenceNow(t.date,t.time).hour?s("span",[e._v(e._s(e.GetTimeDifferenceNow(t.date,t.time).hour)+" heure"),e.GetTimeDifferenceNow(t.date,t.time).hour>1?s("span",[e._v("s")]):e._e()]):e._e(),!e.GetTimeDifferenceNow(t.date,t.time).min||e.GetTimeDifferenceNow(t.date,t.time).hour||e.GetTimeDifferenceNow(t.date,t.time).day?e._e():s("span",[e._v(e._s(e.GetTimeDifferenceNow(t.date,t.time).min)+" minute"),e.GetTimeDifferenceNow(t.date,t.time).min>1?s("span",[e._v("s")]):e._e(),e._v(" et ")]),!e.GetTimeDifferenceNow(t.date,t.time).sec||e.GetTimeDifferenceNow(t.date,t.time).hour||e.GetTimeDifferenceNow(t.date,t.time).day?e._e():s("span",[e._v(e._s(e.GetTimeDifferenceNow(t.date,t.time).sec)+" secondes")])]),t.modification_date?s("span",[s("br"),e._v("modifié il y a "),e.GetTimeDifferenceNow(t.modification_date,t.modification_time).day?s("span",[e._v(e._s(e.GetTimeDifferenceNow(t.modification_date,t.modification_time).day)+" jours et ")]):e._e(),e.GetTimeDifferenceNow(t.modification_date,t.modification_time).hour?s("span",[e._v(e._s(e.GetTimeDifferenceNow(t.modification_date,t.modification_time).hour)+" heure"),e.GetTimeDifferenceNow(t.modification_date,t.modification_time).hour>1?s("span",[e._v("s")]):e._e()]):e._e(),!e.GetTimeDifferenceNow(t.modification_date,t.modification_time).min||e.GetTimeDifferenceNow(t.modification_date,t.modification_time).hour||e.GetTimeDifferenceNow(t.modification_date,t.modification_time).day?e._e():s("span",[e._v(e._s(e.GetTimeDifferenceNow(t.modification_date,t.modification_time).min)+" minute"),e.GetTimeDifferenceNow(t.modification_date,t.modification_time).min>1?s("span",[e._v("s")]):e._e(),e._v(" et ")]),!e.GetTimeDifferenceNow(t.modification_date,t.modification_time).sec||e.GetTimeDifferenceNow(t.modification_date,t.modification_time).hour||e.GetTimeDifferenceNow(t.modification_date,t.modification_time).day?e._e():s("span",[e._v(e._s(e.GetTimeDifferenceNow(t.modification_date,t.modification_time).sec)+" secondes")])]):e._e()]),s("v-card-actions",[s("v-spacer"),s("v-btn",{directives:[{name:"show",rawName:"v-show",value:t.id_author==e.user.id||1==e.user.user_role||2==e.user.user_role,expression:"item.id_author == user.id || user.user_role ==1 || user.user_role ==2"}],on:{click:function(s){e.dialog_modif=!0,e.IDpostToModify=t.id,e.textToModify=t.text}}},[s("v-icon",{directives:[{name:"show",rawName:"v-show",value:t.id_author==e.user.id||1==e.user.user_role||2==e.user.user_role,expression:"item.id_author == user.id || user.user_role ==1 || user.user_role ==2"}],on:{click:function(s){e.dialog_modif=!0,e.IDpostToModify=t.id,e.textToModify=t.text}}},[e._v("mdi-comment-edit-outline")])],1),s("v-btn",{directives:[{name:"show",rawName:"v-show",value:t.id_author==e.user.id||1==e.user.user_role||2==e.user.user_role,expression:"item.id_author == user.id || user.user_role ==1 || user.user_role ==2"}],on:{click:function(s){s.stopPropagation(),e.dialog=!0,e.IDpostToDelete=t.id}}},[s("v-icon",{directives:[{name:"show",rawName:"v-show",value:t.id_author==e.user.id||1==e.user.user_role||2==e.user.user_role,expression:"item.id_author == user.id || user.user_role ==1 || user.user_role ==2"}],on:{click:function(s){s.stopPropagation(),e.dialog=!0,e.IDpostToDelete=t.id}}},[e._v("mdi-delete-forever-outline")])],1),s("v-btn",{on:{click:function(s){e.dialog_comment=!0,e.IDpostToComment=t.id,e.commentToAdd=""}}},[s("v-icon",{on:{click:function(s){e.dialog_comment=!0,e.IDpostToComment=t.id,e.commentToAdd=""}}},[e._v("mdi-chat-plus-outline")])],1),s("v-spacer"),0!==t.comments.length?s("v-btn",{staticClass:"chevron_comment",attrs:{icon:""},on:{click:function(s){e.commentActive=t.id,e.show=!e.show}}},[s("v-icon",[e._v(e._s(e.commentActive==t.id&&e.show?"mdi-chevron-up":"mdi-chevron-down"))])],1):e._e()],1),s("v-expand-transition",[s("div",{directives:[{name:"show",rawName:"v-show",value:e.commentActive==t.id&&e.show,expression:"commentActive==item.id && show"}]},e._l(t.comments,(function(n){return s("div",{key:n.id},[s("v-divider"),s("v-card-text",[e._v(" "+e._s(n.text)+" ")]),s("v-card-text",{staticClass:"caption text-right"},[s("v-row",{attrs:{align:"center",justify:"end"}},[s("v-icon",{directives:[{name:"show",rawName:"v-show",value:n.id_author==e.user.id||1==e.user.user_role||2==e.user.user_role,expression:"items.id_author == user.id || user.user_role ==1 || user.user_role ==2"}],staticClass:"mr-1",on:{click:function(t){e.dialog_modif_com=!0,e.IDcommentToModify=n.id,e.textToModify=n.text}}},[e._v("mdi-comment-edit-outline")]),s("span",{staticClass:"subheading"}),s("v-icon",{directives:[{name:"show",rawName:"v-show",value:n.id_author==e.user.id||1==e.user.user_role||2==e.user.user_role,expression:"items.id_author == user.id || user.user_role ==1 || user.user_role ==2"}],staticClass:"mr-1",on:{click:function(t){t.stopPropagation(),e.dialog_com=!0,e.IDcommentToDelete=n.id}}},[e._v("mdi-delete-forever-outline")]),s("span",{staticClass:"subheading"})],1),s("p",[null!==n.username?s("span",[e._v("@"+e._s(n.username))]):e._e(),null==n.username?s("span",[e._v("L'auteur à supprimé son compte,")]):e._e(),n.modification_date?e._e():s("span",[s("br"),e._v("publié il y a "),e.GetTimeDifferenceNow(n.date,n.time).day?s("span",[e._v(e._s(e.GetTimeDifferenceNow(n.date,n.time).day)+" jours et ")]):e._e(),e.GetTimeDifferenceNow(n.date,n.time).hour?s("span",[e._v(e._s(e.GetTimeDifferenceNow(n.date,n.time).hour)+" heure"),e.GetTimeDifferenceNow(n.date,n.time).hour>1?s("span",[e._v("s")]):e._e()]):e._e(),!e.GetTimeDifferenceNow(n.date,n.time).min||e.GetTimeDifferenceNow(n.date,n.time).hour||e.GetTimeDifferenceNow(n.date,n.time).day?e._e():s("span",[e._v(e._s(e.GetTimeDifferenceNow(n.date,n.time).min)+" minute"),e.GetTimeDifferenceNow(n.date,n.time).min>1?s("span",[e._v("s")]):e._e(),e._v(" et ")]),!e.GetTimeDifferenceNow(n.date,n.time).sec||e.GetTimeDifferenceNow(n.date,n.time).hour||e.GetTimeDifferenceNow(n.date,n.time).day?e._e():s("span",[e._v(e._s(e.GetTimeDifferenceNow(n.date,n.time).sec)+" secondes")])]),n.modification_date?s("span",[s("br"),e._v("modifié il y a "),e.GetTimeDifferenceNow(n.modification_date,n.modification_time).day?s("span",[e._v(e._s(e.GetTimeDifferenceNow(n.modification_date,n.modification_time).day)+" jours et ")]):e._e(),e.GetTimeDifferenceNow(n.modification_date,n.modification_time).hour?s("span",[e._v(e._s(e.GetTimeDifferenceNow(n.modification_date,n.modification_time).hour)+" heure"),e.GetTimeDifferenceNow(t.modification_date,t.modification_time).hour>1?s("span",[e._v("s")]):e._e()]):e._e(),!e.GetTimeDifferenceNow(n.modification_date,n.modification_time).min||e.GetTimeDifferenceNow(n.modification_date,n.modification_time).hour||e.GetTimeDifferenceNow(n.modification_date,n.modification_time).day?e._e():s("span",[e._v(e._s(e.GetTimeDifferenceNow(n.modification_date,n.modification_time).min)+" minute"),e.GetTimeDifferenceNow(n.modification_date,n.modification_time).min>1?s("span",[e._v("s")]):e._e(),e._v(" et ")]),!e.GetTimeDifferenceNow(n.modification_date,n.modification_time).sec||e.GetTimeDifferenceNow(n.modification_date,n.modification_time).hour||e.GetTimeDifferenceNow(n.modification_date,n.modification_time).day?e._e():s("span",[e._v(e._s(e.GetTimeDifferenceNow(n.modification_date,n.modification_time).sec)+" secondes")])]):e._e()])],1)],1)})),0)])],1)],1)})),s("div",{staticClass:"text-center"},[e.page>=2?s("v-btn",{staticClass:"mx-2",attrs:{dark:"",color:"primary"},on:{click:function(t){e.page--,e.shuffleArray(),e.getAllPosts()}}},[s("v-icon",[e._v("mdi-arrow-left-circle-outline")])],1):e._e(),e.page<e.numberOfPosts/5?s("v-btn",{staticClass:"mx-2",attrs:{dark:"",color:"primary"},on:{click:function(t){e.page++,e.shuffleArray(),e.getAllPosts()}}},[s("v-icon",[e._v("mdi-arrow-right-circle-outline ")])],1):e._e(),s("p",[e._v(e._s(e.page)+" sur "+e._s(e.maxPages)+" - "+e._s(e.numberOfPosts)+" Commentaires")])],1),s("v-dialog",{attrs:{"max-width":"400"},model:{value:e.dialog_modif,callback:function(t){e.dialog_modif=t},expression:"dialog_modif"}},[s("v-card",[s("v-card-title",{staticClass:"headline"},[e._v("Modification d'un post")]),s("v-card-text",[s("v-container",[s("v-row",[s("v-text-field",{attrs:{label:"Voulez-vous modifier ce post ?",required:""},model:{value:e.textToModify,callback:function(t){e.textToModify=t},expression:"textToModify"}})],1)],1)],1),s("v-card-actions",[s("v-spacer"),s("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(t){e.modifyPost(),e.getAllPosts()}}},[e._v("Oui")]),s("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:function(t){e.dialog_modif=!1}}},[e._v("Non")])],1)],1)],1),s("v-dialog",{attrs:{"max-width":"290"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[s("v-card",[s("v-card-title",{staticClass:"headline"},[e._v("Suppression d'un post")]),s("v-card-text",[e._v("Voulez-vous définitivement supprimer ce post ?")]),s("v-card-actions",[s("v-spacer"),s("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(t){e.deletePost(),e.getAllPosts()}}},[e._v("Oui")]),s("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("Non")])],1)],1)],1),s("v-dialog",{attrs:{"max-width":"600"},model:{value:e.dialog_comment,callback:function(t){e.dialog_comment=t},expression:"dialog_comment"}},[s("v-card",[s("v-card-title",{staticClass:"headline"},[e._v("Ajouter un commentaire")]),s("v-card-text",[s("v-container",[s("v-row",[s("v-text-field",{attrs:{label:"Ecrivez votre commentaire",required:""},model:{value:e.commentToAdd,callback:function(t){e.commentToAdd=t},expression:"commentToAdd"}})],1)],1)],1),s("v-card-actions",[s("v-spacer"),s("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(t){e.commentPost(),e.getAllPosts()}}},[e._v("Commenter")]),s("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:function(t){e.dialog_comment=!1}}},[e._v("Annuler")])],1)],1)],1),s("v-dialog",{attrs:{"max-width":"400"},model:{value:e.dialog_modif_com,callback:function(t){e.dialog_modif_com=t},expression:"dialog_modif_com"}},[s("v-card",[s("v-card-title",{staticClass:"headline"},[e._v("Modification d'un commentaire")]),s("v-card-text",[s("v-container",[s("v-row",[s("v-text-field",{attrs:{label:"Voulez-vous modifier ce commentaire ?",required:""},model:{value:e.textToModify,callback:function(t){e.textToModify=t},expression:"textToModify"}})],1)],1)],1),s("v-card-actions",[s("v-spacer"),s("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(t){e.modifyComment(),e.getAllPosts()}}},[e._v("Oui")]),s("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:function(t){e.dialog_modif_com=!1}}},[e._v("Non")])],1)],1)],1),s("v-dialog",{attrs:{"max-width":"290"},model:{value:e.dialog_com,callback:function(t){e.dialog_com=t},expression:"dialog_com"}},[s("v-card",[s("v-card-title",{staticClass:"headline"},[e._v("Suppression d'un commentaire")]),s("v-card-text",[e._v("Voulez-vous définitivement supprimer ce commentaire ?")]),s("v-card-actions",[s("v-spacer"),s("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(t){e.deleteComment(),e.getAllPosts()}}},[e._v("Oui")]),s("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:function(t){e.dialog_com=!1}}},[e._v("Non")])],1)],1)],1)],2)],1):e._e()])},U=[],E=(s("99af"),s("d3b7"),s("d4ec")),$=function e(t,s,n,o){Object(E["a"])(this,e),this.email=t,this.username=s,this.password=n,this.role=o},z=s("bc3a"),F={data:function(){return{loading:!1,load:!1,posts:[],error:null,valid:!1,snackbar:!1,multiLine:!0,modified_text:!1,dialog:!1,dialog_modif:!1,dialog_comment:!1,dialog_com:!1,dialog_modif_com:!1,show:!1,commentActive:null,commentShow:!1,IDpostToDelete:"",IDpostToModify:"",IDpostToComment:"",IDcommentToDelete:"",IDcommentToModify:"",commentToAdd:"",textToModify:"",input_modified_post:"",maxPages:"",numberOfPosts:"",page:"1",token:"",ClrSnack:"error",index:0,colorArray:["#333399","#6666cc","#19194d","#cc5200","#662900","#80000d"],user:new $("email","username","id","","",""),newPost:"",resultMessage:"",newPostRules:[function(e){return!!e}]}},created:function(){this.verificationLog(),this.shuffleArray(),this.getNumberOfPosts(),this.getAllPosts(),this.getUser()},methods:{shuffleArray:function(){for(var e=this.colorArray,t=e.length-1;t>0;t--){var s=Math.floor(Math.random()*(t+1)),n=e[t];e[t]=e[s],e[s]=n}return e},verificationLog:function(){sessionStorage.getItem("user")?console.log("l'utilisateur est bien connecté"):document.location.href="/"},GetTimeDifferenceNow:function(e,t){var s={},n=e,o=t,a=new Date(n+" "+o),r=new Date-a;return r=Math.floor(r/1e3),s.sec=r%60,r=Math.floor((r-s.sec)/60),r>=1&&(s.min=r%60),r=Math.floor((r-s.min)/60),r>=1&&(s.hour=r%24),r=Math.floor((r-s.hour)/24),r>=1&&(s.day=r),s},getNumberOfPosts:function(){var e=this,t=function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){try{z.get("http://localhost:3000/api/publication/getPosts",{params:{number_of_posts:500,page:1}}).then((function(t){if(201==t.status){sessionStorage.removeItem("numberOfPosts");var s=t.data.allPostsCommentsGet.length;sessionStorage.setItem("numberOfPosts",s),e(s)}}))}catch(t){console.log(t)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return s=e.sent,e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();s().then((function(){var t=sessionStorage.getItem("numberOfPosts");e.numberOfPosts=JSON.parse(t),e.maxPages=Math.ceil(e.numberOfPosts/5)}))},getAllPosts:function(){var e=this;this.error=this.post=null,this.loading=!0,this.load=!1;var t=function(){var t=Object(k["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){try{z.get("http://localhost:3000/api/publication/getPosts",{params:{number_of_posts:5,page:e.page}}).then((function(e){201==e.status&&(sessionStorage.removeItem("posts"),sessionStorage.setItem("posts",JSON.stringify(e.data.allPostsCommentsGet))),t(e.data.allPostsCommentsGet)})),e.loading=!1,e.load=!0}catch(s){console.log(s)}})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),s=function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return s=e.sent,e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();s().then((function(){var t=sessionStorage.getItem("posts");e.posts=JSON.parse(t),console.log(e.posts)}))},sendNewPost:function(){var e=this,t=new Date,s={userId:this.user.id,text:this.newPost,publication_date:"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate()),publication_time:"".concat(t.getHours(),":").concat(t.getMinutes(),":").concat(t.getSeconds())};console.log(t),console.log(s);var n=function(){var t=Object(k["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,z({method:"post",url:"http://localhost:3000/api/publication/addPost",headers:{authorization:"".concat(e.token)},data:{newPost:s}});case 3:n=t.sent,201==n.status?(e.resultMessage="Nouveau text posté !",e.newPost="",e.ClrSnack="success",console.log("nouveau post ajouté"),console.log(n.data.message),console.log(e.resultMessage)):e.resultMessage="Le message n'a pas pu être posté, merci de recommencer ultérieurement.",t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),e.resultMessage="Le message n'a pas pu être posté, merci de recommencer ultérieurement.",console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();n(),this.snackbar=!0},getUser:function(){var e=sessionStorage.getItem("user"),t=JSON.parse(e);this.user.username=t.userName,this.user.email=t.email,this.user.id="".concat(t.user_id),this.user.user_role=t.user_role,this.token=t.token,console.log(t)},modifyPost:function(){var e=this,t=new Date,s={userId:this.user.id,id_post:this.IDpostToModify,new_text:this.textToModify,new_publication_date:"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate()),new_publication_time:"".concat(t.getHours(),":").concat(t.getMinutes(),":").concat(t.getSeconds())};console.log(s);var n=function(){var t=Object(k["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,z({method:"put",url:"http://localhost:3000/api/publication/updatePost",headers:{authorization:"".concat(e.token)},data:{newPost:s}});case 3:n=t.sent,201==n.status?(e.resultMessage="Nouveau text posté !",e.ClrSnack="success",console.log("nouveau post ajouté"),console.log(n.data.message),console.log(e.resultMessage)):e.resultMessage="Le message n'a pas pu être posté, merci de recommencer ultérieurement.",t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),e.resultMessage="Le message n'a pas pu être posté, merci de recommencer ultérieurement.",console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();n(),this.dialog_modif=!1,this.snackbar=!0,this.getAllPosts()},deletePost:function(){var e=this,t=function(){var t=Object(k["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,z({method:"delete",url:"http://localhost:3000/api/publication/deletePost",headers:{authorization:"".concat(e.token)},params:{userId:e.user.id,id_post:e.IDpostToDelete}});case 3:s=t.sent,201==s.status?(e.resultMessage="Post supprimé !",e.dialog=!1,e.ClrSnack="success",console.log("Le post a bien été supprimé"),console.log(s.data.message),console.log(e.resultMessage)):e.resultMessage="Le message n'a pas pu être supprimé, merci de recommencer ultérieurement.",t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),e.resultMessage="Le message n'a pas pu être supprimé, merci de recommencer ultérieurement.",console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();t(),this.snackbar=!0,this.getAllPosts()},commentPost:function(){var e=this,t=new Date,s=function(){var s=Object(k["a"])(regeneratorRuntime.mark((function s(){var n,o;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return n={userId:e.user.id,id_post:e.IDpostToComment,text:e.commentToAdd,publication_date:"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate()),publication_time:"".concat(t.getHours(),":").concat(t.getMinutes(),":").concat(t.getSeconds())},s.prev=1,s.next=4,z({method:"post",url:"http://localhost:3000/api/publication/addComment",headers:{authorization:"".concat(e.token)},data:{newComment:n}});case 4:o=s.sent,201==o.status?(e.resultMessage="Commentaire ajouté !",e.dialog_comment=!1,e.ClrSnack="success"):(e.ClrSnack="error",e.resultMessage="Le commentaire n'a pas pu être ajouté, merci de recommencer ultérieurement."),s.next=13;break;case 8:s.prev=8,s.t0=s["catch"](1),e.ClrSnack="error",e.resultMessage="Le commentaire n'a malheureusement pas pu être ajouté, merci de recommencer ultérieurement.",console.log(s.t0);case 13:case"end":return s.stop()}}),s,null,[[1,8]])})));return function(){return s.apply(this,arguments)}}();s(),this.snackbar=!0,this.getAllPosts()},modifyComment:function(){var e=this,t=new Date,s={userId:this.user.id,id_comment:this.IDcommentToModify,new_text:this.textToModify,new_comment_date:"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate()),new_comment_time:"".concat(t.getHours(),":").concat(t.getMinutes(),":").concat(t.getSeconds())};console.log(s);var n=function(){var t=Object(k["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,z({method:"put",url:"http://localhost:3000/api/publication/updateComment",headers:{authorization:"".concat(e.token)},data:{newComment:s}});case 3:n=t.sent,201==n.status?(e.resultMessage="Nouveau text posté !",e.ClrSnack="success",console.log("Commentaire modifié"),console.log(n.data.message),console.log(e.resultMessage)):e.resultMessage="Le message n'a pas pu être posté, merci de recommencer ultérieurement.",t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),e.resultMessage="Le message n'a pas pu être posté, merci de recommencer ultérieurement.",console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();n(),this.dialog_modif_com=!1,this.snackbar=!0},deleteComment:function(){var e=this,t=function(){var t=Object(k["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,z({method:"delete",url:"http://localhost:3000/api/publication/deleteComment",headers:{authorization:"".concat(e.token)},params:{userId:e.user.id,id_comment:e.IDcommentToDelete}});case 3:s=t.sent,201==s.status?(e.resultMessage="Commentaire supprimé !",e.dialog_com=!1,e.ClrSnack="success"):e.resultMessage="Le commentaire n'a pas pu être supprimé, merci de recommencer ultérieurement.",t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),e.resultMessage="Le commentairee n'a pas pu être supprimé, merci de recommencer ultérieurement.",console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();t(),this.dialog_com=!1,this.snackbar=!0,this.getAllPosts()}}},q=F,B=(s("65f6"),s("b0af")),J=s("99d9"),Y=s("169a"),H=s("ce7e"),K=s("0789"),Q=s("132d"),W=s("2fa4"),X=Object(c["a"])(q,L,U,!1,null,null,null),Z=X.exports;l()(X,{VBtn:m["a"],VCard:B["a"],VCardActions:J["a"],VCardSubtitle:J["b"],VCardText:J["c"],VCardTitle:J["d"],VContainer:N["a"],VDialog:Y["a"],VDivider:H["a"],VExpandTransition:K["a"],VForm:T["a"],VIcon:Q["a"],VRow:v["a"],VSnackbar:D["a"],VSpacer:W["a"],VTextField:M["a"]});var ee=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mon_profil"},[s("v-container",[s("v-row",{attrs:{align:"center",justify:"center"}},[s("v-col",{staticClass:"elevation-10 rounded",attrs:{cols:"10",md:"6"}},[s("v-avatar",{attrs:{color:"teal",size:"48"}},[s("span",{staticClass:"white--text headline"},[e._v(e._s(e.initiales))])]),s("v-list-item",[s("v-list-item-content",[s("v-list-item-title",{staticClass:"title"},[e._v("Vous êtes connectés sous le nom de "),s("br"),e._v(" "+e._s(e.user.username))]),s("v-list-item-subtitle",[e._v("Compte "),3==e.user.role?s("span",[e._v("Utilisateur")]):e._e(),2==e.user.role?s("span",[e._v("Modérateur")]):e._e(),1==e.user.role?s("span",[e._v("Administrateur")]):e._e()]),s("div",{attrs:{cols:"8",md:"10"}},[s("v-btn",{staticClass:"mr-4",attrs:{disabled:!e.valid,color:"error"},on:{click:function(t){e.dialog_deleteUser=!0}}},[e._v(" Supprimer le compte ")])],1),s("v-dialog",{attrs:{"max-width":"350"},model:{value:e.dialog_deleteUser,callback:function(t){e.dialog_deleteUser=t},expression:"dialog_deleteUser"}},[s("v-card",[s("v-card-title",{staticClass:"headline"},[e._v("Suppression du compte")]),s("v-card-text",[e._v("Voulez-vous définitivement supprimer votre compte ?")]),s("v-card-actions",[s("v-spacer"),s("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(t){return e.DeleteUser()}}},[e._v("Oui")]),s("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:function(t){e.dialog_deleteUser=!1}}},[e._v("Non")])],1)],1)],1)],1)],1),s("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[s("v-text-field",{attrs:{rules:e.usernameRules,label:"Nom d'utilisateur"},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}}),s("v-text-field",{attrs:{rules:e.emailRules,label:"Adresse mail",type:"email"},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}}),s("v-text-field",{attrs:{rules:e.oldPasswordRules,label:"Mot de passe actuel",type:"password"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}}),s("v-checkbox",{attrs:{label:"Changer le mot de passe",color:"orange"},model:{value:e.changePsw,callback:function(t){e.changePsw=t},expression:"changePsw"}}),1==e.changePsw?s("v-text-field",{attrs:{rules:e.newPasswordRules,label:"Nouveau mot de passe",type:"password"},model:{value:e.user.new_password,callback:function(t){e.$set(e.user,"new_password",t)},expression:"user.new_password"}}):e._e()],1),s("v-btn",{staticClass:"mr-4",attrs:{disabled:!e.valid,color:"success"},on:{click:function(t){e.UpdateUser(),e.snackbar=!0}}},[e._v(" Valider ")]),s("v-snackbar",{attrs:{color:e.ClrSnack,"multi-line":e.multiLine,timeout:4e3},scopedSlots:e._u([{key:"action",fn:function(t){var n=t.attrs;return[s("v-btn",e._b({on:{click:function(t){e.snackbar=!1,e.updateName=!1,e.updateEmail=!1,e.updatePassword=!1,e.dialog_deleteUser=!1}}},"v-btn",n,!1),[e._v(" Fermer ")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.resultMessage)+" "),1==e.updateName?s("span",[e._v("Nom d'utilisateur mis à jour"),s("br")]):e._e(),1==e.updateEmail?s("span",[e._v("Email mis à jour"),s("br")]):e._e(),1==e.updatePassword?s("span",[e._v("Mot de passe mis à jour")]):e._e()])],1)],1)],1)],1)},te=[],se=function e(t,s,n,o){Object(E["a"])(this,e),this.email=t,this.username=s,this.password=n,this.new_password=o},ne=s("bc3a"),oe={name:"profile",data:function(){return{changePsw:!1,dialog_deleteUser:!1,user:new se("email","username","","","",""),currentUser:new se("email","username","","","",""),initiales:null,snackbar:!1,ClrSnack:"error",multiLine:!0,valid:!1,resultMessage:"",resultCode:"",updateName:!1,updateEmail:!1,updatePassword:!1,emailRules:[function(e){return/.+@.+\..+/.test(e)||"Merci d'entrer un email valide"}],usernameRules:[function(e){return e&&e.length<=10||"Le nom d'utilisateur doit contenir 10 caractères au maximum"}],oldPasswordRules:[function(e){return!!e||"Name is required"},function(e){return e&&e.length<=10||"L'ancien mot de passe doit contenir 10 caractères au maximum"}],newPasswordRules:[function(e){return e&&e.length<=10||"Le nouveau mot de passe doit contenir 10 caractères au maximum"}]}},created:function(){this.GetUser(),this.GetInitiale()},methods:{GetInitiale:function(){this.initiales=this.user.username.charAt(0)+this.user.username.charAt(1)},GetUser:function(){var e=sessionStorage.getItem("user"),t=JSON.parse(e);this.user.username=t.userName,this.user.email=t.email,this.user.role=t.user_role,this.user.id=t.user_id,this.currentUser.username=t.userName,this.currentUser.email=t.email,this.currentUser.role=t.user_role,this.currentUser.id=t.user_id},UpdateUser:function(){var e,t,s=this,n=sessionStorage.getItem("user"),o=JSON.parse(n),a=function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){try{ne({method:"get",url:"http://localhost:3000/api/auth/getuser",params:{id:o.user_id}}).then((function(t){e(t.data)}))}catch(t){console.log(t)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r=function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){try{ne({method:"put",url:"http://localhost:3000/api/auth/updateuser",headers:{authorization:"".concat(o.token)},data:{id:o.user_id,new_username:s.user.username,new_email:s.user.email,new_password:s.user.new_password,password:s.user.password}}).then((function(t){console.log("Requête OK"),console.log(t.status),console.log(t),console.log(t.data.message),201==t.status?(sessionStorage.setItem("resultCode","201"),sessionStorage.setItem("resultMessage","Les données de l'utilisateur ont été mises à jour."),e({message:"utilisateur mis à jour"})):202==t.status?(sessionStorage.setItem("resultCode","202"),sessionStorage.setItem("resultMessage","Mauvais mot de passe"),e({message:"Mauvais mot de passe, les données n'ont pas pu être mises à jour"})):(sessionStorage.setItem("resultCode","200"),sessionStorage.setItem("resultMessage","Les données de l'utilisateur n'ont pas pu être mises à jour. ".concat(t.data.message)),e({message:"L'utilisateur n'a pas pu être mis à jour. ".concat(t.data.message)}))})).catch((function(e){console.log("Erreur lors de l'appel de la fonction"+e)}))}catch(t){console.log(t)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=function(){var s=Object(k["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,a();case 2:return e=s.sent,s.next=5,r();case 5:return t=s.sent,console.log(e),console.log(t),s.abrupt("return",t);case 9:case"end":return s.stop()}}),s)})));return function(){return s.apply(this,arguments)}}();this.user.username!==this.currentUser.username||this.user.email!==this.currentUser.email||""!==this.user.new_password&&this.user.new_password!==this.user.password?i().then((function(){s.resultMessage=sessionStorage.getItem("resultMessage"),s.resultCode=sessionStorage.getItem("resultCode"),console.log(s.resultMessage),console.log(s.resultCode),201==s.resultCode?(s.user.username!==s.currentUser.username&&(s.updateName=!0,console.log(s.updateName),console.log("Changement du nom d'utilisateur"),s.currentUser.username=s.user.username,s.snackbar=!0,s.ClrSnack="success"),s.user.email!==s.currentUser.email&&(s.updateEmail=!0,console.log(s.updateEmail),console.log("Changement de l'adresse email"),s.currentUser.email=s.user.email,s.snackbar=!0,s.ClrSnack="success"),""!==s.user.new_password&&s.user.new_password!==s.user.password&&(s.updatePassword=!0,console.log(s.updatePassword),console.log("Changement du mot de passe"),s.snackbar=!0,s.ClrSnack="success",s.user.new_password=""),s.getUserDB()):(s.snackbar=!0,s.ClrSnack="error")})):(this.resultMessage="Aucune donnée n'a été modifiée",console.log("Pas de modification à apporter"))},DeleteUser:function(){var e=this,t=function(){var t=Object(k["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ne({method:"delete",url:"http://localhost:3000/api/auth/deleteUser",headers:{authorization:"".concat(e.token)},params:{userId:e.user.id,password:e.user.password}});case 3:s=t.sent,201==s.status?(e.resultMessage="Utilisateur supprimé !",e.resultCode=201,e.dialog=!1,e.ClrSnack="success",console.log("L'utilisateur a bien été supprimé"),console.log(s.data.message),console.log(e.resultMessage),setTimeout((function(){document.location.href="/logout"}),3e3)):(e.resultMessage="L'utilisateur n'a pas pu être supprimé, merci de recommencer ultérieurement.",e.ClrSnack="error"),t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),e.resultMessage="L'utilisateur n'a pas pu être supprimé, merci de recommencer ultérieurement.",console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();t(),this.snackbar=!0},getUserDB:function(){var e=this,t={username:this.user.username,password:this.user.password},s=function(){var s=Object(k["a"])(regeneratorRuntime.mark((function s(){var n,o,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,ne.post("http://localhost:3000/api/auth/login",t);case 3:if(n=s.sent,201!=n.status){s.next=13;break}return console.log("Vous êtes connecté sous le nom de ".concat(n.data.username)),o={userName:n.data.username,user_id:n.data.userId,user_role:n.data.userRole,email:n.data.email,token:n.data.token},console.log(n),a=JSON.stringify(o),sessionStorage.setItem("user",a),console.log(sessionStorage.getItem("user")),e.user.password="",s.abrupt("return",{message:"Mise à jour des données de ".concat(n.data.username)});case 13:200==n.status&&(e.resultMessage=n.data.err),console.log(n.data.message),console.log(e.resultMessage),s.next=21;break;case 18:s.prev=18,s.t0=s["catch"](0),console.log(s.t0);case 21:case"end":return s.stop()}}),s,null,[[0,18]])})));return function(){return s.apply(this,arguments)}}();s(),setTimeout((function(){document.location.href="/profile"}),1500)}}},ae=oe,re=(s("2a37"),s("8212")),ie=s("ac7c"),ce=s("da13"),ue=s("5d23"),le=Object(c["a"])(ae,ee,te,!1,null,null,null),de=le.exports;l()(le,{VAvatar:re["a"],VBtn:m["a"],VCard:B["a"],VCardActions:J["a"],VCardText:J["c"],VCardTitle:J["d"],VCheckbox:ie["a"],VCol:p["a"],VContainer:N["a"],VDialog:Y["a"],VForm:T["a"],VListItem:ce["a"],VListItemContent:ue["a"],VListItemSubtitle:ue["b"],VListItemTitle:ue["c"],VRow:v["a"],VSnackbar:D["a"],VSpacer:W["a"],VTextField:M["a"]});var me=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[1==e.connected?s("div",[s("h2",[e._v("Vous allez être déconnecté du réseau social")]),s("button",{on:{click:function(t){return e.deconnexion()}}},[e._v("Retenter la déconnexion")])]):e._e(),0==e.connected?s("h2",[e._v("Merci de votre visite, "),s("br"),e._v("Vous êtes maintenant déconnecté, vous allez être redirigé vers la page d'accueil")]):e._e()])},pe=[],fe={data:function(){return{connected:!1}},mounted:function(){this.deconnexion()},methods:{deconnexion:function(){sessionStorage.removeItem("posts"),sessionStorage.removeItem("postsComs"),sessionStorage.removeItem("user"),console.log("déconnection page"),console.log(sessionStorage.getItem("user")),sessionStorage.getItem("user")?(this.connected=!0,console.log("Vous êtes encore connecté")):(this.$store.dispatch("deconnected"),this.connected=!1,console.log("Vous êtes maintenant déconnecté, vous allez être redirigé vers la page d'accueil"),console.log(this.$store.state.connexion.isConnected),setTimeout((function(){document.location.href="/"}),3e3))}}},ve=fe,ge=Object(c["a"])(ve,me,pe,!1,null,null,null),_e=ge.exports;n["a"].use(h["a"]);var he=[{path:"/",name:"Signup",component:P},{path:"/login",name:"Login",component:A},{path:"/blackboard",name:"Blackboard",component:Z},{path:"/profile",name:"Profile",component:de},{path:"/logout",name:"Logout",component:_e}],we=new h["a"]({mode:"history",routes:he}),be=we,ke=s("f309");n["a"].use(ke["a"]);var xe=new ke["a"]({icons:{iconfont:"mdiSvg"}}),Ce=s("2f62");n["a"].use(Ce["a"]);var ye=new Ce["a"].Store({state:{connexion:{isConnected:!1,token:{},username:{},userRole:{}},posts:[]},mutations:{CONNECTED:function(e,t){e.connexion.isConnected=!0,e.connexion.token=t.token,e.connexion.username=t.username,e.connexion.userRole=t.userRole},DECONNECTED:function(e){e.connexion.isConnected=!1,e.connexion.token={},e.connexion.username={},e.connexion.userRole={}}},actions:{connected:function(e,t){e.commit("CONNECTED",t)},deconnected:function(e){e.commit("DECONNECTED")}},modules:{}});n["a"].config.productionTip=!1,new n["a"]({vuetify:xe,router:be,store:ye,render:function(e){return e(_)}}).$mount("#app")},"5c0b":function(e,t,s){"use strict";var n=s("9c0c"),o=s.n(n);o.a},"5ccf":function(e,t,s){},"65f6":function(e,t,s){"use strict";var n=s("e031"),o=s.n(n);o.a},"9c0c":function(e,t,s){},b78e:function(e,t,s){e.exports=s.p+"img/logo_groupomania.b5590f4d.png"},e031:function(e,t,s){},ec02:function(e,t,s){e.exports=s.p+"img/icon-above-font.4f12eeff.png"},effc:function(e,t,s){}});
//# sourceMappingURL=app.19bc5d79.js.map